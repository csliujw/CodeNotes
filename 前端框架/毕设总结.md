# 业务

## 常见的demo处理策略：

后台系统数据新增时，有关数据类别的回显；可采用一开始进入后台系统，便将对于的数据查询出来，直接存入session/redis等中，下次需要使用时直接查询session/redis便可。更新方面，可类别每插入一条新数据便重新缓存数据。【内存作为高速缓存，缓存需要经常用到的数据】

图片上传回显的操作，采用三方库完成，图片上传完毕后，将图片的“服务器地址”返回给浏览器。

分页查询需要查询到数据的总数，以便计算到底有多少页数据。

条件查询，采用原生JDBC的话，若安全要求性不高，可采用字符串拼接（用StringBuilder，StringBuffer有加锁的问题，jdk默认会把字符+++，转为StringBuffer）

# 技术

## 文件上传

采用Servlet3.0 无需三方jar的支持

注意，需要写上注解，文件上传的参考代码如下

```java
@WebServlet("/upload")
@MultipartConfig
public class UploadController extends HttpServlet {

    private void upload(HttpServletRequest request, HttpServletResponse response) throws Exception {
        UploadData uploadData = null;
        // 采用的虚拟路径，虚拟路径  localhostxxxx/upload  ==> E:\upload\
        File path = new File("E:" + File.separator + "upload" + File.separator);
        //获取文件  layui 默认为 file
        Part img = request.getPart("file");

        String filePath = path.getPath() + File.separator + UUID.randomUUID().toString().replace("-", "") + ".png";
        // 写入文件 未看到关闭流的方法 可能是内部自带关闭 
        img.write(filePath);
        uploadData = new UploadData(0, "", filePath.replace("E:", ""));
        response.getWriter().write(new Gson().toJson(uploadData));
    }
}
```



## 分页查询 pojo的封装

分页查询的pojo应该根据约定的数据格式进行选取。我用的是layui，所以采用如下的格式，供参考

```java
package com.lt.pojo;

import java.util.List;

/**
 * 分页bean，用于处理layui请求
 */
public class PageBean<T> {
    private int limit;  // 每页限制查询的数据条数
    private int page; // 当前页数 从1开始
    private int code = 0; // 状态码
    private long count; // 数据总数
    private String msg = ""; // 额外的消息
    private List<T> data; // 查询到的数据集

    public PageBean() {}

    public PageBean(int page, int limit) {
        this.page = page;
        this.limit = limit;
    }

    public PageBean(int page, int limit, int count) {
        this.page = page;
        this.limit = limit;
        this.count = count;
    }
    
    // 内部计算好 select * from user limit start, end 中的start和end
    public void calculate(){
        int page = this.getPage();
        int limit = this.getLimit();
        this.setPage((page - 1) * limit);
    }
}
```

# 代码

**代码规范存在较大的问题，主要问题如下：**

- 同一类型的临时变量命名不统一。如Connection对象，部分地方采用connection部分地方采用conn
- 代码冗余度高，存在大量的重复代码。
- 数据库操作方面SQL语句的拼接写法不一致，可读性差。
- 前端代码html，css，js未做到有效分离。js代码冗余度高。

# 前端

缺少一个熟悉的后台模板