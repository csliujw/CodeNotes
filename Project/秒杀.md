# 概述

应对大并发：

- 如何利用缓存
- 如何使用异步
- 优雅编写代码

> 秒杀

- 分布式会话
- 商品列表页
- 商品详情页
- 订单详情页
- 系统压测
- 缓存优化：先写数据库还是先写缓存。
- 消息队列：RabbitMQ 异步下单。
- 接口安全

## 整体流程

- Spring Boot 环境搭建
    - 继承 thymeleaf（后期改成layui），Result 结果封装
    - 继承 MyBatis + Druid
    - 继承 Jedis + Redis 安装 + 通用缓存 key 封装。
- 实现登录
    - 数据库设计
    - 明文密码两次 MD5
    - JSR303参数校验 + 全局异常处理器
    - 分布式 Session
- 实现秒杀
    - 数据库设计
    - 商品列表页
    - 商品详情页
    - 订单详情页
- JMeter 压测
    - JMeter 入门
    - 自定义变量模拟多用户
    - JMeter命令行使用
    - Spring Boot 打 war 包
- 页面优化技术
    - 页面缓存 + URL缓存 + 对象缓存（减少对数据库的访问）
    - 页面静态化，前后端分离
    - 静态资源优化
    - CDN优化
- 接口优化
    - Redis预减库存减少数据库访问
    - 内存标记减少 Redis 访问
    - RabbitMQ队列缓冲，异步下单，增强用户体验
    - 访问 Nginx 水平扩展
    - 压测
- 安全优化
    - 秒杀接口地址隐藏
    - 数学公式验证码（拉长访问时间）
    - 接口防刷

# 登录功能

![image-20220214114241349](img\image-20220214114241349.png)

![image-20220214115419732](img\image-20220214115419732.png)

引入MD5 依赖。

![image-20220214120511746](img\image-20220214120511746.png)

jsr303 校验依赖

![image-20220214130753808](img\image-20220214130753808.png)

JSR303参数校验+全局异常处理器

分布式Session

- 用户登录成功后，生成UUID，传给客户端。客户端每次请求用户的信息时，携带这个UUID给服务器，服务器就可以通过这个UUID查询到用户的信息。
- 延迟 cookie 有效期，可以使用 SpringMVC 的内容协商来简化用户信息的获取和cookie的延长。

## 压测

JMeter 压测

Redis 压测
![image-20220215180830670](C:\development\Code\note\CodeNotes\Project\img\image-20220215180830670.png)

## 打包

![image-20220215180954494](C:\development\Code\note\CodeNotes\Project\img\image-20220215180954494.png)

![image-20220215181332400](C:\development\Code\note\CodeNotes\Project\img\image-20220215181332400.png)

![image-20220215192735684](C:\development\Code\note\CodeNotes\Project\img\image-20220215192735684.png)

把页面缓存在客户端
