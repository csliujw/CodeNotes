# 杂谈

## 魔法方法概述

还记得Python的那些魔法方法吗`__getitem__`,为什么会有这些？

Python解释器遇到特殊的句法时，会使用特殊方法去激活一些基本的对象操作，这些特殊方法的名字以两个下划线开头，两个下划线结尾。

- `eg`：`obj[key] 实质上是调用了 __getitem__方法`

  ```python
  """体会__getitem__"""
  class obj():
      def __init__(self) -> None:
          self.list = [1, 2, 3, 4, 5, 6, 7, 8]
  
      def __getitem__(self, i):
          return self.list[i]
  
  if __name__ == "__main__":
      o = obj()
      print(o[0]) # output 1 实际上会调用 
  ```
  
- 对这段代码debug也可以发现是调用了`__getitem__方法`

以上的方法称之为魔术方法

## 常见魔法方法

<a href="https://pycoders-weekly-chinese.readthedocs.io/en/latest/issue6/a-guide-to-pythons-magic-methods.html">**魔术方法在线文档~**</a>

### **比较相关的魔术方法**

```python
__eq__(self,other)		self == other
__ne__(self,other)		self != otehr
__lt__(self,other)		self <  other
__gt__(self,other)		self >  otehr
__le__(self,other)		self <= other
__ge__(self,other)		self >= other
```

<span style="color:green">**经典demo**</span>

```python
class obj():
    def __init__(self,value) -> None:
        self.value = value

    def __eq__(self, o: object) -> bool:
        print("进入了 eq 方法")
        return self.value == o.value

    def __ne__(self, o: object) -> bool:
        print("进入了 ne 方法")
        return self.value != o.value

    def __gt__(self,o:object)-> bool:
        print("进入了 gt 方法")
        return self.value > o.value

if __name__ == "__main__":
    o1 = obj(1)
    o2 = obj(3)
    print(o1 == o2)
    print("=="*50)
    print(o1 != o2)
```

### 数值处理的魔术方法

<span style="color:green">**一元操作符和函数**</span>

```python
__pos__(self) # 实现正号的特性(比如 +some_object)

__neg__(self) # 实现负号的特性(比如 -some_object)

__abs__(self) # 实现内置 abs() 函数的特性。

__invert__(self) # 实现 ~ 符号的特性。为了说明这个特性
```

<span style="color:green">**普通算数操作符**</span>

```python
__add__(self, other) # 实现加法。 

__sub__(self, other) # 实现减法。 

__mul__(self, other) # 实现乘法。 

__floordiv__(self, other) # 实现 // 符号实现的整数除法。

__div__(self, other) # 实现 / 符号实现的除法。 

__truediv__(self, other) # 实现真除法。

# 注意只有只用了 from __future__ import division 的时候才会起作用。

__mod__(self, other) # 实现取模算法 % 

__divmod___(self, other) # 实现内置 divmod() 算法 

__pow__ # 实现使用 ** 的指数运算 

__lshift__(self, other) # 实现使用 << 的按位左移动 

__rshift__(self, other) # 实现使用 >> 的按位左移动

__and__(self, other) # 实现使用 & 的按位与 

__or__(self, other) # 实现使用 | 的按位或 

__xor__(self, other) # 实现使用 ^ 的按位异或
```

### 其他种类的魔术方法

```python
__str__(self)  # str(self)
 
__repr__(self) # repr(self)

__len__(self) # len(self)
```

### **<span style="color:green">容器后的魔法</span>**

```python
__len__(self) # 然会容器长度

__getitem__(self, key) # self[key] 

__setitem__(self, key, value) # self[key] = value 

__delitem__(self, key) # del self[key]

__iter__(self) # 返回一个容器的迭代器

__reversed__(self) # 实现当 reversed() 被调用时的行为

__contains__(self, item) # 当调用 in 和 not in 来测试成员是否存在时候 

__concat__(self, other) # 这个操作不知道做啥的！！
```

